{"ts":1390534651823,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// LED vars \nconst int ledPin = 13;\nconst int pwmPin = 3;\n\n// LED read vars\nString inputString = \"\";         // a string to hold incoming data\nboolean toggleComplete = false;  // whether the string is complete\nboolean pwmComplete = false;  \n\n// Potmeter vars\nconst int analogInPin = A0;\nint sensorValue = 0;        // value read from the potmeter\nint prevValue = 0;          // previous value from the potmeter\n\nvoid setup() {\n  // initialize serial:\n  Serial.begin(9600);\n  // init LEDS\n  pinMode(ledPin,OUTPUT);\n  pinMode(pwmPin,OUTPUT);\n  digitalWrite(ledPin,0);\n  analogWrite(pwmPin,0);\n}\n\nvoid loop() {\n   // Recieve data from Node and write it to a String\n   while (Serial.available() && toggleComplete == false && pwmComplete == false) {\n    char inChar = (char)Serial.read();\n    if(inChar == 'E'){ // end character for led\n     toggleComplete = true;\n    }\n    if(inChar == 'P'){\n      pwmComplete = true;\n    }\n    else{\n      inputString += inChar; \n    }\n  }\n  // Toggle LED 13\n  if(!Serial.available() && toggleComplete == true)\n  {\n    // convert String to int. \n    int recievedVal = stringToInt();\n    \n    if(recievedVal == 0)\n    {\n      digitalWrite(ledPin,recievedVal);\n    }\n    else if(recievedVal == 1)\n    {\n      digitalWrite(ledPin,recievedVal);\n    }    \n    toggleComplete = false;\n  }\n  // Dim LED 3\n  if(!Serial.available() && pwmComplete == true)\n  {\n    // convert String to int. \n    int recievedVal = stringToInt();\n    \n    analogWrite(pwmPin,recievedVal);\n    \n    pwmComplete = false;\n  }\n    // Potmeter\n     sensorValue = analogRead(analogInPin);   \n    // read the analog in value:\n    if(prevValue != sensorValue){\n      Serial.print(\"B\"); // begin character \n      Serial.print(sensorValue);  \n      Serial.print(\"E\"); // end character\n      prevValue = sensorValue;\n    }  \n  delay(50); // give the Arduino some breathing room.\n}\n\nint stringToInt()\n{\n    char charHolder[inputString.length()+1];\n    inputString.toCharArray(charHolder,inputString.length()+1);\n    inputString = \"\";\n    int _recievedVal = atoi(charHolder);\n    return _recievedVal;\n}\r\n"]],"start1":0,"start2":0,"length1":0,"length2":2094}]],"length":2094}
